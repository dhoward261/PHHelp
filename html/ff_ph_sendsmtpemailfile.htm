<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<link rel="stylesheet" type="text/css" href="ph-help.css">
<title>ph_sendsmtpemailfile</title>
</head>
<body>
<div class=ph1>

ph_sendsmtpemailfile PowerHome formula function

</div>
<div class=ph2>Description</div>
<div class=ph3>

Sends an email message with file attachments using SMTP.

</div>
<div class=ph4>Syntax</div>
<div class=ph5>

ph_sendsmtpemailfile ( s, n, s, s, s, s, s )

</div>
<div>
<table width=100%>
<tr>
<td><span class=ph6>Argument</span></td>
<td><span class=ph7>Description</span></td>
</tr>
<tr>
<td class=ph8>

Server

</td>
<td class=ph9>

<span class="ph-datype">String</span>. The IP or DSN of the SMTP server.</td>
</tr>
<tr>
<td class=ph8>

Port

</td>
<td class=ph9>

<span class="ph-datype">Number</span>. The port of the SMTP server.  This is typically port 25.</td>
</tr>
<tr>
<td class=ph8>

fromAddr

</td>
<td class=ph9>

<span class="ph-datype">String</span>. The email address you are sending the email from.  Most SMTP servers require you to enter a valid email address registered on the SMTP server.  You may optionally enter a userid and password if your SMTP server requires authentication.</td>
</tr>
<tr>
<td class=ph8>

toAddr</td>
<td class=ph9>

<span class="ph-datype">String</span>. The email addresses you wish to send a message to.  Separate multiple email addresses with commas.</td>
</tr>
<tr>
<td class=ph8>

Subject

</td>
<td class=ph9>

<span class="ph-datype">String</span>. The subject of the email.</td>
</tr>
<tr>
<td class=ph8>

text

</td>
<td class=ph9>

<span class="ph-datype">String</span>. The text of the email message.</td>
</tr>
<tr>
<td class=ph8>

filespec

</td>
<td class=ph9>

<span class="ph-datype">String</span>. The full path and filename of the file to attach to the email.  Separate multiple files with the | (vertical bar) character.</td>
</tr>
</table>
</div>
<div class=ph10>Return value</div>
<div class=ph11>

Integer.  Returns 0 if successful.  Any other value signifies an error occurred.  You can specify multiple recipients by separating the email addresses with commas.  Specify multiple files by separating the path/filename with the | (vertical bar) character.

</div>
<div class=ph12>Usage</div>
<div class=ph13>

Use this function to send email with file attachments using raw SMTP rather than the MAPI interface that the ph_sendemail function uses.  If an error occurs while sending using SMTP, the PowerHome system will not hang like it does when sending using MAPI.
<br><br>
If your SMTP server requires authentication, then supply the userid and password in the third parameter after the "From" email address.  Separate the "from" email address, userid, and password with commas (do not add spaces).

</div>

<div class=ph10>
Examples
</div>
<div class=ph11>
The following examples demonstrate typical syntax/usage for this function. <br>
</div>
<div class=ph20>
&bull;&nbsp;ph_sendsmtpemailfile("smtp.mail.yahoo.com",465,"yourname@yahoo.com,login,password", "8885551212@txt.att.net","Motion Alert","Driveway Motion on CAM1 detected.","C:\powerhome\web\CAM1.jpg") 
</div>

</body>
</html>

