<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<link rel="stylesheet" type="text/css" href="ph-help.css">
<title>ph.createpluginpt</title>
</head>
<body>
<div class=ph1>

ph.createpluginpt Windows Script Host function

</div>
<div class=ph2>Description</div>
<div class=ph3>

Creates a "passthru" window object for use by plugins that may not have a Windows handle associated with them.

</div>
<div class=ph4>Syntax</div>
<div class=ph5>

ph.createpluginpt ( index )

</div>
<div>
<table width=100%>
<tr>
<td><span class=ph6>Argument</span></td>
<td><span class=ph7>Description</span></td>
</tr>
<tr>
<td class=ph8>

index

</td>
<td class=ph9>

Long.  The index number of the Generic Plugin the passthru is being attached to.

</td>
</tr>
</table>
</div>
<div class=ph10>Return value</div>
<div class=ph11>

Long.  Returns the handle of the Passthru window.

</div>
<div class=ph12>Usage</div>
<div class=ph13>

The Passthru window is an invisible window with a Windows handle with predefined events enabled.  Certain PowerHome Generic Plugins may not have a handle associated with them but may need to be accessed by external programs using Windows messaging.  The Passthru window provides this necessary handle.  This handle may have Windows messages sent to it which will then be passed to the Generic Plugin defined by the index parameter using the phpi_syscommand function.<br><br>The captured events are 1024 thru 1033.  Both the wparm and lparam values will be passed using the phpi_syscommand function.  Event 1034 is used to close the passthru window if the wparam contains the handle of the passthru and the lparam contains the index of the plugin.  Event 1050 is used to setup a "Wait" timer.  The max wait value is contained in seconds in the lparam value.   When this event is called the passthru will wait until the busy flag is cleared or the max wait value is exceeded.  Event 1051 will clear the busy flag set by event 1050.  The last captured event is event 74 which is used by a COPYDATASTRUCT type of Windows message.  The wparam and lparam values will be passed using the phpi_syscommand function so that the COPYDATASTRUCT structure can be directly accessed by the generic plugin.

</div>
</body>
</html>
